Refactored the API as part of testing. If you're using this, be aware that we are going to do further refactoring soon i.e. the API is currently very unstable.
